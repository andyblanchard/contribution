<template name="contribution">
  <script type="text/javascript" async src="https://platform.twitter.com/widgets.js"></script>

  <!-- Index-banner -->
  <div class="section light-blue darken-2 white-text" id="index-banner">
    <div class="container">
      <div class="row center">
        <div class="col s12 m7 offset-m1 l6 offset-l2">
          <h1 class="header center-on-small-only grey-text text-lighten-4">Contribution</h1>
          {{#unless isTermsAccepted}}
            <h4 class ="center-on-small-only light grey-text text-lighten-5">Please read carefully and thouroughly.</h4>
          {{/unless}}
          {{#if isTermsAccepted}}
          {{#unless isAllAccepted}}
            <h4 class ="center-on-small-only light grey-text text-lighten-5">We want you to understand what you're in for.</h4>
          {{/unless}}
          {{/if}}
          {{#if isAllAccepted}}
            <h4 class ="center-on-small-only light grey-text text-lighten-5">The time has come for you to decide.</h4>
          {{/if}}
        </div>
        <!-- Users network summary -->
        <div class="col s12 m2">
          <!-- Client is connected -->
          {{#if isConnected}}
            {{> network_summary}}
          {{else}}
            <br/>
            <span class="text-light">Try to use me with</span>
            <li><a class="white-text" href="https://metamask.io/" target="_blank"><b>MetaMask</b></a></li>
            <li><a class="white-text" href="https://github.com/ethereum/mist" target="_blank"><b>Mist</b></a></li>
          {{/if}}
        </div>
      </div>
    </div>
  </div>

  {{#if isServerConnected}}
    <!-- Terms&Conditions -->
    <div class="container">
      <div class="row">
        <div class="col s12 m9 offset-m1 l8 offset-l2">
          <!-- Terms Accepted -->
          <h4 class="light">Terms and Conditions</h4>
          <p>I hereby confirm to have read and understood the following document:</p>
          <ul class="collection">
            <li class="collection-item">
              <input {{whenECParamsSet}} type="checkbox" class="filled-in" id="melon-terms" />
              <label for="melon-terms" class="grey-text text-darken-3">
                <a href="#" onclick="window.open('melonprotocol.pdf', '_blank', 'fullscreen=yes'); return false;">Melon Contribution Terms</a>
              </label>
            </li>
          </ul>
          <p>I hereby acknowledge the following points:</p>
          <ul class="collection">
            <li class="collection-item">
              <input {{whenECParamsSet}} type="checkbox" class="filled-in" id="no-equity" />
              <label for="no-equity" class="grey-text text-darken-3">Contributor does not receive equity in Melonport AG.</label>
            </li>
            <li class="collection-item">
              <input {{whenECParamsSet}} type="checkbox" class="filled-in" id="workshop" />
              <label for="workshop" class="grey-text text-darken-3">Contributions will be used to fullfill the workshop mission.</label>
            </li>
          </ul>
          <p>I hereby confirm to be:</p>
          <ul class="collection">
            <li class="collection-item">
              <input {{whenECParamsSet}} type="checkbox" class="filled-in" id="citizen" />
              <label for="citizen" class="grey-text text-darken-3">Non US citizen nor signing on behalf of a US citizen.</label>
            </li>
          </ul>
          <!-- Documents Read -->
          <p>I hereby confirm to have read the following documents:</p>
          <ul class="collection">
            <li class="collection-item">
              <input {{whenECParamsSet}} type="checkbox" class="filled-in" id="melon-whitepaper" />
              <label for="melon-whitepaper" class="grey-text text-darken-3">
                <a href="#" onclick="window.open('melonprotocol.pdf', '_blank', 'fullscreen=yes'); return false;">Melon Protocol Whitepaper</a>
              </label>
            </li>
            <li class="collection-item">
              <input {{whenECParamsSet}} type="checkbox" class="filled-in" id="melon-parity-service-agreement" />
              <label for="melon-parity-service-agreement" class="grey-text text-darken-3">
                <a href="#" onclick="window.open('melonprotocol.pdf', '_blank', 'fullscreen=yes'); return false;">Development Agreement - Melonport AG, Parity Technologies Limited</a>
              </label>
            </li>
            <li class="collection-item">
              <input {{whenECParamsSet}} type="checkbox" class="filled-in" id="parity-whitepaper" />
              <label for="parity-whitepaper" class="grey-text text-darken-3">
                <a href="#" onclick="window.open('melonprotocol.pdf', '_blank', 'fullscreen=yes'); return false;">Parity Project Whitepaper</a>
              </label>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Signature -->
    <div class="container">
      <div class="row">
        <div class="col s12 m9 offset-m1 l8 offset-l2">
          <form class="signature">
            <h4 class="light">Confirmation</h4>
            <p>Please insert the Ethereum address with which you would like to contribute if and only if you have read, acknowledged and agreed upon all of the above terms and conditions.</p>
            <div class="row">
              <div class="input-field col s12">
                <label for="contribution_address" id="contribution-text">Contribution Address</label>
                <label for="contribution_address" id="success-message" class="green-text text-lighten-1"></label>
                <label for="contribution_address" id="error-message" class="red-text text-lighten-1"></label>
                <input {{whenECParamsSet}} id="contribution_address" type="text" length="42" maxlength="42" required>
              </div>
            </div>
            {{#if isAllAccepted}}
              {{#if isECParamsSet}}
                <a href="#results" class="signature btn btn-primary">Show results</a>
              {{else}}
                <button type="submit" class="signature btn btn-primary">I confirm</button>
              {{/if}}
            {{else}}
              <button type="submit" class="disabled btn btn-primary">I confirm</button>
            {{/if}}
          </form>
        </div>
      </div>
    </div>

    {{#if isECParamsSet}}
    <!-- Result -->
    <div class="container">
      <div class="row">
        <div class="col s12 m9 offset-m1 l8 offset-l2">
          <div id="results" class="section scrollspy">
            <h4 class="light">Signature</h4>
            <p>With these parameters you can contribute to Melon.</p>
            {{#if isECParamsSet}}
              <blockquote>
                <p> Ethereum Address: <b>{{getContributionAddress}}</b></p>
                <p> Sig.v is: <b>{{getSigV}}</b></p>
                <p> Sig.r is: <b>{{getSigR}}</b></p>
                <p> Sig.s is: <b>{{getSigS}}</b></p>
              </blockquote>
              <p> To contribute you can either use the Ethereum Wallet, MetaMask or Mist.</p>
            {{/if}}
          </div>
        </div>
      </div>
    </div>

    {{#if isConnected}}
      <!-- Send Funds -->
      <div class="container">
        <div class="row">
          <div class="col s12 m9 offset-m1 l8 offset-l2">
              <form class="amount">
                <h4 class="light">Send Funds</h4>
                <p>Please insert the amount of Ether you'd like to contribute from your contribution address: {{getContributionAddress}}</p>
                <div class="row">
                  <div class="input-field col s12">
                    <input id="ether_amount" type="number" step="any" class="validate">
                    <label for="ether_amount">Ether Amount</label>
                  </div>
                </div>
                <button type="submit" class="amount btn btn-primary">Send</button>
              </form>
          </div>
        </div>
      </div>
    {{else}}
      <!-- Send Funds -->
      <div class="container">
        <div class="row">
          <div class="col s12 m9 offset-m1 l8 offset-l2">
            <div id="results" class="section scrollspy">
              <h4 class="light">Send Funds</h4>
              <p>You are currently not connected to this decentralised application. You can either use this application in conjunction with:</p>
              <blockquote>
                <p><a href="https://metamask.io/" target="_blank"><b>MetaMask</b></a></p>
                <p><a href="https://github.com/ethereum/mist" target="_blank"><b>Mist</b></a></p>
              </blockquote>
              <p>Or by sending funds using the Ethereum Wallet. For this you can see the video below for instructions:</p>
              <blockquote>
                <p><a href="https:/melonport.com/" target="_blank"><b>Ethereum Wallet Video</b></a></p>
              </blockquote>
              <p> Thank you for contributing.</p>
            </div>
          </div>
        </div>
      </div>
      {{/if}}
    {{/if}}

  {{else}}
    <!-- Not connected to the node -->
    <div class="container">
      <div class="row">
        <div class="col s12 m9 offset-m1 l8 offset-l2">
          <div id="results" class="section scrollspy">
            <h4 class="light">Ethereum node down</h4>
            <p>Unfortunately the Ethereum node seems to be down. <a href="mailto:team@melonport.com?subject=Ethereum Node Down on Contribution app" target="_top">Please contact us</a>. Thanks.</p>
          </div>
        </div>
      </div>
    </div>
  {{/if}}
</template>
